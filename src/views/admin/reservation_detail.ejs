<!doctype html><html lang="es"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title><%= title %> · <%= site.title %></title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/styles.css" rel="stylesheet">
<style>:root{ --brand-green:<%= site.navbar_color || '#1b8f3a' %>; }</style>
</head><body>
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center gap-2" href="/">
      <% if(site.logo_url){ %><img src="<%= site.logo_url %>" class="brand-logo" alt="Logo"><% } else { %><strong><%= site.title %></strong><% } %>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav"><span class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse" id="nav">
    </div>
  </div>
</nav>
<main class="container my-4">
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="mb-0">Reserva <small class="text-muted"><%= r.id %></small></h3>
  <a href="/admin" class="btn btn-outline-secondary">Volver al panel</a>
</div>

<p><strong>Actividad:</strong> <%= r.act_name %> — <%= r.party_size %> personas</p>
<p><strong>Horario:</strong> <%= dayjs(r.start_at).format('DD/MM/YYYY HH:mm') %> - <%= dayjs(r.end_at).format('HH:mm') %></p>
<p>
  <strong>Titular:</strong>
  <%= r.holder_name %> — Tel: <%= r.phone %> — Email: <%= r.email || '—' %>
</p>
<p>
  <strong>Datos para depósito:</strong>
  <% if (site.bank_name || site.bank_account) { %>
    Banco: <%= site.bank_name || '—' %>,
    Cuenta: <%= site.bank_account || '—' %>,
    Referencia: <%= r.phone %>,
    Monto: $ <%= (r.amount_cents/100).toFixed(2) %> MXN
  <% } else { %>
    Configura los datos bancarios en <em>Admin &gt; Datos bancarios</em>.
  <% } %>
</p>
<p>
  <strong>Estado:</strong>
  <span class="badge bg-<%= r.status==='paid'?'success':'secondary' %>"><%= r.status %></span>
  <% if (r.checkin_code) { %>
    <span class="ms-3">
      <strong>Código de acceso:</strong>
      <code><%= r.checkin_code %></code>
    </span>
  <% } %>
</p>
<div class="mb-3">
  <% if(r.status==='pending'){ %>
    <form class="d-inline" method="post" action="/admin/reservas/<%= r.id %>/confirm"><button class="btn btn-success btn-sm">Marcar como PAGADO</button></form>
  <% } %>
  <form class="d-inline" method="post" action="/admin/reservas/<%= r.id %>/cancel" onsubmit="return confirm('¿Cancelar reserva?')"><button class="btn btn-danger btn-sm">Cancelar</button></form>
</div>
<hr/>
<h5>Agregar visita extra</h5>
<form method="post" action="/admin/reservas/<%= r.id %>/extra" class="row g-2">
  <div class="col-md-6">
    <select name="activity_id" class="form-select">
      <% acts.forEach(function(a){ %><option value="<%= a.id %>"><%= a.name %></option><% }) %>
    </select>
  </div>
  <div class="col-md-6"><input name="note" class="form-control" placeholder="Nota (opcional)"></div>
  <div class="col-12"><button class="btn btn-outline-primary btn-sm">Agregar</button></div>
</form>
<a href="/admin" class="btn btn-primary admin-back">Volver al panel</a>

</main>

<footer class="site-footer text-white mt-4" style="background:var(--brand-green);">

</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body></html>
